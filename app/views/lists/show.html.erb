<div class="container-fluid py-4" style="max-width: 1400px;">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb mb-2">
          <li class="breadcrumb-item"><%= link_to "Lists", lists_path %></li>
          <li class="breadcrumb-item active" aria-current="page"><%= @list.name %></li>
        </ol>
      </nav>
      <h1 class="fs-2 mb-0"><%= @list.name %></h1>
    </div>
    <div class="d-flex gap-2">
      <%= link_to "Edit", edit_list_path(@list), class: "btn btn-outline-secondary" %>
      <%= button_to "Delete", @list, method: :delete, data: { turbo_confirm: "Are you sure? This will delete the list and all subscriptions." }, class: "btn btn-outline-danger" %>
    </div>
  </div>

  <!-- List Stats -->
  <div class="row g-4 mb-4">
    <div class="col-md-3">
      <div class="card border">
        <div class="card-body">
          <div class="text-muted small mb-1">Total Subscribers</div>
          <div class="fs-3 fw-semibold"><%= number_with_delimiter(@list.subscribers_count) %></div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card border">
        <div class="card-body">
          <div class="text-muted small mb-1">Campaigns</div>
          <div class="fs-3 fw-semibold"><%= @list.campaigns.count %></div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card border">
        <div class="card-body">
          <div class="text-muted small mb-1">Segments</div>
          <div class="fs-3 fw-semibold"><%= @list.segments.count %></div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card border">
        <div class="card-body">
          <div class="text-muted small mb-1">Subscription Form</div>
          <div>
            <% if @list.enable_subscription_form %>
              <span class="badge bg-success">Enabled</span>
            <% else %>
              <span class="badge bg-secondary">Disabled</span>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- List Details -->
  <div class="mb-4">
    <h2 class="fs-4 mb-3">List Details</h2>
    <div class="card border">
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-6">
            <div class="text-muted small mb-1">Name</div>
            <div class="fw-semibold"><%= @list.name %></div>
          </div>
          <div class="col-md-6">
            <div class="text-muted small mb-1">Description</div>
            <div class="fw-semibold"><%= @list.description.presence || "—" %></div>
          </div>
          <div class="col-md-6">
            <div class="text-muted small mb-1">Double Opt-in</div>
            <div class="fw-semibold"><%= @list.double_opt_in ? "Enabled" : "Disabled" %></div>
          </div>
          <div class="col-md-6">
            <div class="text-muted small mb-1">Created</div>
            <div class="fw-semibold"><%= @list.created_at.strftime("%B %d, %Y at %I:%M %p") %></div>
          </div>
          <% if @list.enable_subscription_form %>
            <div class="col-12">
              <div class="text-muted small mb-1">Subscription Form URL</div>
              <div class="input-group">
                <input type="text" class="form-control form-control-sm" readonly value="<%= subscribe_url(@list.id) %>">
                <button class="btn btn-sm btn-outline-secondary" type="button" onclick="navigator.clipboard.writeText('<%= subscribe_url(@list.id) %>')">Copy</button>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Subscribers -->
  <div class="mb-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="fs-4 mb-0">Recent Subscribers</h2>
      <%= link_to "View All Subscribers", subscribers_path(list_id: @list.id), class: "btn btn-sm btn-outline-primary" %>
    </div>

    <% if @subscribers.any? %>
      <div class="card border">
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="table-light">
              <tr>
                <th>Email</th>
                <th>Status</th>
                <th>Source</th>
                <th>Subscribed</th>
              </tr>
            </thead>
            <tbody>
              <% @subscribers.each do |subscriber| %>
                <tr>
                  <td><%= link_to subscriber.email, subscriber, class: "text-decoration-none" %></td>
                  <td><span class="badge status-<%= subscriber.status %>"><%= subscriber.status.titleize %></span></td>
                  <td><%= subscriber.source || "—" %></td>
                  <td><%= time_ago_in_words(subscriber.created_at) %> ago</td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    <% else %>
      <div class="alert alert-info">No subscribers yet. Share your subscription form or import subscribers to get started.</div>
    <% end %>
  </div>

  <!-- Recent Campaigns -->
  <% if @recent_campaigns.any? %>
    <div class="mb-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="fs-4 mb-0">Recent Campaigns</h2>
        <%= link_to "View All Campaigns", campaigns_path(list_id: @list.id), class: "btn btn-sm btn-outline-primary" %>
      </div>

      <div class="card border">
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="table-light">
              <tr>
                <th>Name</th>
                <th>Status</th>
                <th>Subject</th>
                <th>Created</th>
              </tr>
            </thead>
            <tbody>
              <% @recent_campaigns.each do |campaign| %>
                <tr>
                  <td><%= link_to campaign.name, campaign, class: "text-decoration-none" %></td>
                  <td><span class="badge status-<%= campaign.status %>"><%= campaign.status.titleize %></span></td>
                  <td><%= truncate(campaign.subject, length: 50) %></td>
                  <td><%= time_ago_in_words(campaign.created_at) %> ago</td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  <% end %>
</div>
