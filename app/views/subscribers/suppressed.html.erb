<div class="container-fluid py-4" style="max-width: 1400px;">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="fs-2 mb-2">Suppression List</h1>
      <p class="text-muted mb-0">Subscribers who have bounced or complained</p>
    </div>
    <%= link_to "← Back to Subscribers", subscribers_path, class: "btn btn-outline-secondary" %>
  </div>

  <div class="alert alert-info mb-4">
    <h5 class="alert-heading">About the Suppression List</h5>
    <p class="mb-0">
      Subscribers on this list won't receive any campaigns. They're automatically excluded from all sends to protect your sender reputation.
      <strong>Bounced</strong> means their email address is invalid or their mailbox is full.
      <strong>Complained</strong> means they marked your email as spam.
    </p>
  </div>

  <% if @suppressed_subscribers.any? %>
    <div class="card border mb-4">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="text-muted small">
            Showing <%= @suppressed_subscribers.count %> of <%= number_with_delimiter(@total_count) %> suppressed subscribers
          </div>
        </div>

        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="table-light">
              <tr>
                <th>Email</th>
                <th>Status</th>
                <th>Date</th>
                <th>Source</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <% @suppressed_subscribers.each do |subscriber| %>
                <tr>
                  <td>
                    <%= link_to subscriber.email, subscriber, class: "text-decoration-none" %>
                  </td>
                  <td>
                    <span class="badge status-<%= subscriber.status %>">
                      <%= subscriber.status.titleize %>
                    </span>
                  </td>
                  <td>
                    <% if subscriber.bounced_at %>
                      <%= subscriber.bounced_at.strftime("%B %d, %Y") %>
                    <% elsif subscriber.complained_at %>
                      <%= subscriber.complained_at.strftime("%B %d, %Y") %>
                    <% else %>
                      —
                    <% end %>
                  </td>
                  <td>
                    <span class="text-muted small"><%= subscriber.source || 'Unknown' %></span>
                  </td>
                  <td>
                    <%= link_to "View", subscriber, class: "btn btn-sm btn-outline-secondary me-1" %>
                    <%= button_to "Reactivate", reactivate_subscriber_path(subscriber), method: :post,
                        class: "btn btn-sm btn-outline-success",
                        data: { turbo_confirm: "Are you sure you want to reactivate #{subscriber.email}? They will be able to receive campaigns again." } %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Simple Pagination -->
    <% if @total_count > 50 %>
      <div class="d-flex justify-content-center gap-2">
        <% current_page = params[:page].to_i %>
        <% current_page = 1 if current_page < 1 %>
        <% total_pages = (@total_count / 50.0).ceil %>

        <% if current_page > 1 %>
          <%= link_to "← Previous", suppressed_subscribers_path(page: current_page - 1), class: "btn btn-outline-secondary" %>
        <% end %>

        <span class="btn btn-outline-secondary disabled">
          Page <%= current_page %> of <%= total_pages %>
        </span>

        <% if current_page < total_pages %>
          <%= link_to "Next →", suppressed_subscribers_path(page: current_page + 1), class: "btn btn-outline-secondary" %>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <div class="card border border-2 border-dashed">
      <div class="card-body text-center py-5">
        <h5 class="mb-3">No Suppressed Subscribers</h5>
        <p class="text-muted mb-0">You don't have any bounced or complained subscribers. This is good for your sender reputation!</p>
      </div>
    </div>
  <% end %>
</div>
